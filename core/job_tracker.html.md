# Job Tracker


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## TranscriptionJob

Dataclass representing a transcription job’s state. This is a
lightweight structure for tracking job progress without the process
management complexity of the old `TranscriptionJobManager`.

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-workflow-transcription-single-file/blob/main/cjm_fasthtml_workflow_transcription_single_file/core/job_tracker.py#L17"
target="_blank" style="float:right; font-size:smaller">source</a>

### TranscriptionJob

``` python

def TranscriptionJob(
    id:str, plugin_name:str, file_path:str, file_name:str, status:str='pending', created_at:str=<factory>,
    started_at:Optional=None, completed_at:Optional=None, result:Optional=None, error:Optional=None,
    metadata:Dict=<factory>, task:Optional=None
)->None:

```

*Represents a transcription job’s state.*

## TranscriptionJobTracker

Lightweight job state tracker that works with the new `PluginManager`
architecture. Unlike the old `TranscriptionJobManager`, this class:

- Does **not** manage worker processes (handled by `PluginManager`)
- Does **not** handle resource scheduling (handled by `PluginManager`’s
  scheduler)
- Does **not** manage plugin loading (handled by `PluginManager`)

It simply tracks job state and coordinates with an externally-provided
`PluginManager` for execution.

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-workflow-transcription-single-file/blob/main/cjm_fasthtml_workflow_transcription_single_file/core/job_tracker.py#L33"
target="_blank" style="float:right; font-size:smaller">source</a>

### TranscriptionJobTracker

``` python

def TranscriptionJobTracker(
    on_job_completed:Optional=None, # Completion callback
):

```

*Lightweight job state tracker for transcription workflows.*

## Usage Example

The
[`TranscriptionJobTracker`](https://cj-mills.github.io/cjm-fasthtml-workflow-transcription-single-file/core/job_tracker.html#transcriptionjobtracker)
is used in conjunction with a `PluginManager` (provided by the host
application):

``` python
from cjm_plugin_system.core.manager import PluginManager
from cjm_fasthtml_workflow_transcription_single_file.core.job_tracker import (
    TranscriptionJobTracker
)

# Host application provides the PluginManager
plugin_manager = PluginManager()
plugin_manager.load_all()

# Workflow creates its own job tracker
def on_complete(job_id, tracker):
    job = tracker.get_job(job_id)
    print(f"Job {job_id} completed: {job.file_name}")

job_tracker = TranscriptionJobTracker(on_job_completed=on_complete)

# Start a job
job = job_tracker.create_job(
    plugin_name="cjm-transcription-plugin-whisper",
    file_path="/path/to/audio.mp3",
    file_name="audio.mp3"
)

# Execute via PluginManager (in an async context)
async def run_transcription():
    job_tracker.mark_running(job.id)
    try:
        result = await plugin_manager.execute_plugin_async(
            job.plugin_name,
            audio=job.file_path
        )
        job_tracker.mark_completed(job.id, result)
    except Exception as e:
        job_tracker.mark_failed(job.id, str(e))
```

``` python
# Test: Create job tracker
tracker = TranscriptionJobTracker()

# Test: Create job
job = tracker.create_job(
    plugin_name="test-plugin",
    file_path="/test/audio.mp3",
    file_name="audio.mp3"
)

assert job.status == "pending"
assert job.plugin_name == "test-plugin"
assert job.file_name == "audio.mp3"
print(f"Created job: {job.id}")

# Test: Mark running
tracker.mark_running(job.id)
assert tracker.get_job(job.id).status == "running"
print(f"Job status: {tracker.get_job(job.id).status}")

# Test: Mark completed
tracker.mark_completed(job.id, {"text": "Hello world", "metadata": {}})
assert tracker.get_job(job.id).status == "completed"
result = tracker.get_job_result(job.id)
assert result["status"] == "success"
assert result["data"]["text"] == "Hello world"
print(f"Job result: {result}")

print("All tests passed!")
```

    Created job: 60f8e8ee-80e5-4a01-af8e-bd3a22bbdc31
    Job status: running
    Job result: {'status': 'success', 'data': {'text': 'Hello world', 'metadata': {}}}
    All tests passed!
